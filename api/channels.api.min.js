"use strict";function ChannelsAPI(serverPath){let token=null;const request=req=>fetch(serverPath,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({token:token||req.token||"",method:req.method||"",path:req.path||"",data:req.data||{}})}).then(response=>response.json()),setToken=newToken=>(token=newToken,!0),Channel=requestPath=>{let parsedPath=(requestPath=>{let reqPath,parts=(reqPath=requestPath?requestPath.toString():"/").toString().replace(/\/\//g,"/").replace(/^\//,"").replace(/\/$/,"").replace(/\/\//g,"/").split("/"),channel="/"+parts.slice(0,-1).join("/"),key=parts.slice(-1)[0],slash="";return"/"!==channel&&(slash="/"),{path:channel+slash+key,channel:channel,key:key,slash:slash}})(requestPath).path;return{channel:()=>parsedPath,setToken:token=>{setToken(token)},put:data=>((path,data)=>request({method:"put",path:path,data:data}))(parsedPath,data),get:()=>(path=>request({method:"get",path:path}))(parsedPath),del:()=>(path=>request({method:"del",path:path}))(parsedPath),list:query=>((path,data)=>request({method:"list",path:path,data:data}))(parsedPath,query),path:path=>{path||(path="/");let slash="";return"/"!==parsedPath&&(slash="/"),Channel(parsedPath+slash+path)}}};return Channel("/")}